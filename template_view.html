<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.84.0">
    <title>Heroes · Bootstrap v5.0</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/heroes/">



    <!-- Bootstrap core CSS -->
<!-- <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }
      .generalButton {
        margin: 20px 10px 10px 10px;
        padding: 0 15px 0 15px;
        background: transparent;
        
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

    </style>


    <!-- Custom styles for this template -->
    <link href="heroes.css" rel="stylesheet">
  </head>
  <body>
    <?php
      require_once __DIR__.'/../../b24/b24.php';
    ?>
<main>
  <div class="container">
    <div class="px-4 pt-5 my-5 text-center">
      <?php
        $message_type = $_GET['type'];
        if ($message_type == 'whatsapp'):
      ?>
        <h1 class="display-4 fw-bold">Редактирование шаблона WhatsApp</h1>
        <div class="col-lg-6 mx-auto">
          <?php
            $response = file_get_contents('https://b24.mircli24.ru/gupshup.php?type=templates');
            $templates = json_decode($response, true);
            $templates_name = $templates[0];
            $templates = $templates[1]['templates'];
            foreach ($templates as $one_gupshup_template) {
              foreach($templates_name as $template_key => $one_template) {
                if ($one_gupshup_template['id'] == $_GET['message_id'] && $one_gupshup_template['elementName'] == $template_key) {
            ?>
                  <form class="needs-validation" novalidate="">
                    <div class="row g-3">
                      <div class="col-sm-12">
                        <label for="firstName" class="form-label">Имя</label>
                        <input type="text" class="form-control" name="name" id="firstName" placeholder="" value="<?php echo $one_template['name']; ?>" required="required">
                        <div class="invalid-feedback">
                          Действительное имя обязательно.
                        </div>
                      </div>

                      <div class="col-12">
                        <label for="username" class="form-label">Шаблон</label>
                        <div class="input-group has-validation">
                          <textarea class="form-control" id="username" name="template" required="required"><?php echo $one_gupshup_template['data']; ?></textarea>
                          <div class="invalid-feedback">
                            Шаблон обязательно.
                          </div>
                        </div>
                      </div>



                      <div class="col-md-12">
                        <label for="country" class="form-label">Сущности</label>
                      </div>

                    <hr class="my-4">

                    <div class="form-check">
                      <?php
                        if (in_array('lead', $one_template['entities'])) {
                      ?>
                        <input type="checkbox" name="entity" checked value="lead" class="form-check-input" id="same-address">
                      <?php
                        } else {
                      ?>
                        <input type="checkbox" name="entity" value="lead" class="form-check-input" id="same-address">
                      <?php
                        }
                      ?>
                      <label class="form-check-label" for="same-address">Лид</label>
                    </div>

                    <div class="form-check">
                      <?php
                        if (in_array('deal', $one_template['entities'])) {
                      ?>
                        <input type="checkbox" name="entity" checked value="deal" class="form-check-input" id="same-address">
                      <?php
                        } else {
                      ?>
                        <input type="checkbox" name="entity" value="deal" class="form-check-input" id="same-address">
                      <?php
                        }
                      ?>
                      <label class="form-check-label" for="same-address">Сделка</label>
                    </div>

                    <div class="form-check">
                      <?php
                        if (in_array('contact', $one_template['entities'])) {
                      ?>
                        <input type="checkbox" name="entity" checked value="contact" class="form-check-input" id="same-address">
                      <?php
                        } else {
                      ?>
                        <input type="checkbox" name="entity" value="contact" class="form-check-input" id="same-address">
                      <?php
                        }
                      ?>
                      <label class="form-check-label" for="same-address">Контакт</label>
                    </div>

                    <div class="form-check">
                      <?php
                        if (in_array('company', $one_template['entities'])) {
                      ?>
                        <input type="checkbox" name="entity" checked value="company" class="form-check-input" id="same-address">
                      <?php
                        } else {
                      ?>
                        <input type="checkbox" name="entity" value="company" class="form-check-input" id="same-address">
                      <?php
                        }
                      ?>
                      <label class="form-check-label" for="same-address">Компания</label>
                    </div>

                    <hr class="my-4">

                    <div class="col-md-12">
                      <label for="country" class="form-label">Поля</label>
                    </div>

                    <hr class="my-4">
                    
                    <!-- ТУТ  ЦИКЛ ВЫВОДА  КНОПОК КОТОРЫЕ ЗАПУСКАЮТ МОДАЛКУ -->
                     <!--  Кнопка для запуска модалки -->
                    <div>
                      <button type="button" class="btn btn-primary js-button-modal-open" data-bs-toggle="modal" data-bs-target="#Modal" data-field-id="field_one" >
                        Поле №1
                      </button>
                      <input type='hidden' id="field_one" name="field_one">
                      <span id="field_one_text"></span>
                    </div>
                    <div>
                      <button type="button" class="btn btn-primary js-button-modal-open" data-bs-toggle="modal" data-bs-target="#Modal" data-field-id="field_two">
                        Поле №2
                      </button>
                      <input type='hidden' id="field_two" name="field_two">
                      <span id="field_two_text"></span>
                    </div>div>
                    <!-- Модалка Поле 1-->
                    <div class="modal fade" id="Modal"  aria-labelledby="ModalLabel" aria-hidden="true">
                      <div   class="modal-dialog modal-xl" > 
                        <div class="modal-content">
                          <div class="modal-header">
                            <h1 class="modal-title fs-5" id="ModalLabel">Поле №1</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>
                          <div class="modal-body">
                            <!-- Добавление табов в модалку Поле 1 -->
                            <ul class="nav nav-tabs" id="myTab" role="tablist">
                              <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="deal-panel-tab" data-bs-toggle="tab" data-bs-target="#deal-panel" type="button" role="tab" aria-controls="deal-panel" aria-selected="true">Сделка</button>
                              </li>
                              <li class="nav-item" role="presentation">
                                <button class="nav-link" id="lid-panel-tab" data-bs-toggle="tab" data-bs-target="#lid-panel" type="button" role="tab" aria-controls="lid-panel" aria-selected="false">Лид</button>
                              </li>
                              <li class="nav-item" role="presentation">
                                <button class="nav-link" id="contacts-panel-tab" data-bs-toggle="tab" data-bs-target="#contacts-panel" type="button" role="tab" aria-controls="contacts-panel" aria-selected="false">Контакты</button>
                              </li>
                              <li class="nav-item" role="presentation">
                                <button class="nav-link" id="company-panel-tab" data-bs-toggle="tab" data-bs-target="#company-panel" type="button" role="tab" aria-controls="company-panel" aria-selected="false">Компания</button>
                              </li>
                              <li class="nav-item" role="presentation">
                                <button class="nav-link" id="offers-panel-tab" data-bs-toggle="tab" data-bs-target="#offers-panel" type="button" role="tab" aria-controls="offers-panel" aria-selected="false" >Предложения</button>
                              </li>
                            </ul>
                            <div class="tab-content" id="myTabContent">

                              <div class="tab-pane fade show active" id="deal-panel" role="tabpanel" aria-labelledby="deal-panel-tab">
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button " data-bs-dismiss="modal" aria-label="Close"   data-id="field_id"  >ID</button>
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_name">Название</button>
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_type">Тип</button>
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_count">Счет</button>
                              </div>
                             
                              <div class="tab-pane fade " id="lid-panel" role="tabpanel" aria-labelledby="lid-panel-tab">
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_id_1">ID 1</button>
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_name_1">Название 1</button>
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_type_1">Тип 1 </button>
                                <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_count_1">Счет 1</button>
                              </div>
                              
                                <div class="tab-pane fade" id="contacts-panel" role="tabpanel" aria-labelledby="contacts-panel-tab">
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_id_2">ID 2</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_name_2">Название 2</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_type_2">Тип 2</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_count_2">Счет 2</button>
                                </div>
                             
                                <div class="tab-pane fade" id="company-panel" role="tabpanel" aria-labelledby="company-panel-tab">
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_id">ID 3</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_name">Название 3</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_type">Тип 3</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_count">Счет 3</button>
                                </div>
                             
                              <div class="tab-pane fade" id="offers-panel" role="tabpanel" aria-labelledby="offers-panel-tab">
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_id">ID</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_name">Название</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_type">Тип</button>
                                  <button type="button" class="btn btn-outline-dark btn-sm generalButton js-field-button"  data-bs-dismiss="modal" aria-label="Close" data-id="field_count">Счет</button>
                              </div>
                            </div>
                            <!-- EXIT Добавление табов в модалку Поле 1-->
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                          </div>
                        </div>
                      </div>
                    </div>  
                

                       
                    <button class="w-100 btn btn-primary btn-lg" type="submit">Сохранить</button>
                  </form>
            <?php
                  break 2;
                }
              }
            }
          ?>
        </div>
      <?php
        endif;
      ?>
    </div>
  </div>
  <!-- <div class="modal fade show" id="exampleModalXl1" tabindex="-1" aria-labelledby="exampleModalXlLabel" style="display: block;" aria-modal="true" role="dialog">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title h4" id="exampleModalXlLabel">Поле №1</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="flex-shrink-0 p-3 bg-white" style="width: 280px;">
            <ul class="list-unstyled ps-0">
              <?php
                $fields_json = json_decode(file_get_contents(__DIR__.'/../../b24/fields_json.json'), true);
                foreach ($fields_json as $key => $one_fields_group) {
                  switch ($key) {
                    case 'lead':
                      $group_name = 'Лид';
                      break;
                    case 'deal':
                      $group_name = 'Сделка';
                      break;
                    case 'contact':
                      $group_name = 'Контакт';
                      break;
                    case 'company':
                      $group_name = 'Компания';
                      break;
                    case 'quote':
                      $group_name = 'Предложение';
                      break;

                  }
              ?>
                    <li class="mb-1">
                    <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#home-collapse" aria-expanded="false">
                      <!-- ТУТ КАК РАЗ ВЫВОДИТСЯ НАЗВАНИЕ ГРУППЫ ПОЛЕЙ ТИПА ЛИД, СДЕЛКА, КОНТАКТ И Т.Д. -->
                      <?php echo $group_name; ?>
                    </button>
                    <div class="collapse" id="home-collapse" style="">
                      <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                        <!-- ТУТ В ЦИКЛЕ САМИ ПОЛЯ -->
                        <?php
                          foreach ($one_fields_group as $one_field) {
                        ?>
                          <li>
                            <input type="checkbox" name="field" value="<?php echo $one_field['field_id']; ?>" class="form-check-input" id="same-address">
                            <label class="form-check-label" for="same-address"><?php echo $one_field['name']; ?></label>
                          </li>
                        <?php
                          }
                        ?>
                      </ul>
                    </div>
                  </li>
              <?php
                }
              ?>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div> -->




</main>
    <script type='text/javascript' src='//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js'></script>
    
    <!-- <script src="../assets/dist/js/bootstrap.bundle.min.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

<script>
  var $editableFields = $('.js-field-button');
  var $modalOpenButton = $('.js-button-modal-open');
  var input;
  var span;

  $modalOpenButton.on('click', function(event) {
    var $target = $(event.target);
    var data = $target.data();
    var fieldId = data.fieldId;

    input = $('#' + fieldId);
    span = $('#' + fieldId + '_text') 
  });

  $editableFields.on('click', function(event) {
    var $target = $(event.target);
    var fieldId = $target.data().id; 
    var text = $target.text();
  
    input.val(fieldId);
    span.text(text);
  });
</script>
  </body>
</html>
